import type { User } from '../core/auth/auth.model';
import type { Request } from '../shared/models/request.model';
import { COMPLEXITY_WEIGHTS } from '../shared/models/request.model';

function priorityScore(urgency: number, importance: number, complexity: number): number {
  const weight = COMPLEXITY_WEIGHTS[complexity] ?? 0.7;
  return ((urgency + importance) / 2) * weight;
}

export const MOCK_USERS: User[] = [
  {
    id: 'user-functional-1',
    email: 'maria.funcional@tuempresa.com',
    role: 'functional',
    avatar_url: null,
    display_name: 'María García',
  },
  {
    id: 'user-developer-1',
    email: 'carlos.dev@tuempresa.com',
    role: 'developer',
    avatar_url: null,
    display_name: 'Carlos López',
  },
  {
    id: 'user-admin-1',
    email: 'admin@tuempresa.com',
    role: 'admin',
    avatar_url: null,
    display_name: 'Admin',
  },
];

export const MOCK_REQUESTS: Request[] = [
  {
    id: 'req-1',
    title: 'Error al exportar informe PDF',
    description: 'Al generar el informe mensual en PDF la aplicación se cuelga. Reproducible en Chrome.',
    type: 'incidencia',
    status: 'in_progress',
    requester_id: 'user-functional-1',
    developer_id: 'user-developer-1',
    urgency: 5,
    importance: 5,
    complexity: 2,
    priorityScore: priorityScore(5, 5, 2),
    created_at: '2025-01-28T10:00:00Z',
    updated_at: '2025-02-01T14:00:00Z',
  },
  {
    id: 'req-2',
    title: 'Mejora: filtros avanzados en listado',
    description: 'Añadir filtros por fecha, estado y tipo en el listado de solicitudes.',
    type: 'mejora',
    status: 'prioritized',
    requester_id: 'user-functional-1',
    developer_id: null,
    urgency: 2,
    importance: 4,
    complexity: 3,
    priorityScore: priorityScore(2, 4, 3),
    created_at: '2025-01-30T09:00:00Z',
    updated_at: '2025-02-02T11:00:00Z',
  },
  {
    id: 'req-3',
    title: 'Proyecto: integración con ERP',
    description: 'Desarrollar módulo de integración con el ERP corporativo para sincronización de datos.',
    type: 'proyecto',
    status: 'backlog',
    requester_id: 'user-functional-1',
    developer_id: null,
    urgency: 1,
    importance: 5,
    complexity: 5,
    priorityScore: priorityScore(1, 5, 5),
    created_at: '2025-02-01T08:00:00Z',
    updated_at: '2025-02-01T08:00:00Z',
  },
  {
    id: 'req-4',
    title: 'Incidencia: login con Google falla en Safari',
    description: 'En Safari iOS el botón de login con Google no abre el popup.',
    type: 'incidencia',
    status: 'backlog',
    requester_id: 'user-functional-1',
    developer_id: null,
    urgency: 4,
    importance: 4,
    complexity: 2,
    priorityScore: priorityScore(4, 4, 2),
    created_at: '2025-02-03T12:00:00Z',
    updated_at: '2025-02-03T12:00:00Z',
  },
  {
    id: 'req-5',
    title: 'Mejora: notificaciones por email',
    description: 'Enviar email cuando el estado de una solicitud cambie.',
    type: 'mejora',
    status: 'backlog',
    requester_id: 'user-functional-1',
    developer_id: null,
    urgency: 3,
    importance: 3,
    complexity: 3,
    priorityScore: priorityScore(3, 3, 3),
    created_at: '2025-02-04T09:00:00Z',
    updated_at: '2025-02-04T09:00:00Z',
  },
  {
    id: 'req-6',
    title: 'Proyecto: app móvil de consulta',
    description: 'App nativa o PWA para consultar estado de solicitudes desde el móvil.',
    type: 'proyecto',
    status: 'backlog',
    requester_id: 'user-functional-1',
    developer_id: null,
    urgency: 2,
    importance: 4,
    complexity: 5,
    priorityScore: priorityScore(2, 4, 5),
    created_at: '2025-02-05T10:00:00Z',
    updated_at: '2025-02-05T10:00:00Z',
  },
  {
    id: 'req-7',
    title: 'Error 500 en pantalla de detalle',
    description: 'Al abrir el detalle de solicitudes con caracteres especiales en el título se produce error 500.',
    type: 'incidencia',
    status: 'done',
    requester_id: 'user-functional-1',
    developer_id: 'user-developer-1',
    urgency: 5,
    importance: 4,
    complexity: 1,
    priorityScore: priorityScore(5, 4, 1),
    created_at: '2025-01-25T14:00:00Z',
    updated_at: '2025-01-29T16:00:00Z',
  },
  {
    id: 'req-8',
    title: 'Mejora: atajos de teclado',
    description: 'Añadir atajos (Ctrl+S guardar, Ctrl+N nueva solicitud) para usuarios avanzados.',
    type: 'mejora',
    status: 'backlog',
    requester_id: 'user-functional-1',
    developer_id: null,
    urgency: 1,
    importance: 2,
    complexity: 2,
    priorityScore: priorityScore(1, 2, 2),
    created_at: '2025-02-02T11:00:00Z',
    updated_at: '2025-02-02T11:00:00Z',
  },
  {
    id: 'req-9',
    title: 'Incidencia: timeout en reportes grandes',
    description: 'Reportes con más de 10.000 filas provocan timeout. Solicitud de paginación o exportación asíncrona.',
    type: 'incidencia',
    status: 'prioritized',
    requester_id: 'user-functional-1',
    developer_id: null,
    urgency: 4,
    importance: 5,
    complexity: 4,
    priorityScore: priorityScore(4, 5, 4),
    created_at: '2025-02-04T08:00:00Z',
    updated_at: '2025-02-05T09:00:00Z',
  },
  {
    id: 'req-10',
    title: 'Proyecto: dashboard ejecutivo',
    description: 'Nuevo dashboard con KPIs y gráficos para dirección.',
    type: 'proyecto',
    status: 'backlog',
    requester_id: 'user-functional-1',
    developer_id: null,
    urgency: 2,
    importance: 3,
    complexity: 4,
    priorityScore: priorityScore(2, 3, 4),
    created_at: '2025-02-05T14:00:00Z',
    updated_at: '2025-02-05T14:00:00Z',
  },
  {
    id: 'req-11',
    title: 'Mejora: búsqueda full-text',
    description: 'Búsqueda por texto en título y descripción de solicitudes.',
    type: 'mejora',
    status: 'backlog',
    requester_id: 'user-functional-1',
    developer_id: null,
    urgency: 3,
    importance: 4,
    complexity: 3,
    priorityScore: priorityScore(3, 4, 3),
    created_at: '2025-02-06T09:00:00Z',
    updated_at: '2025-02-06T09:00:00Z',
  },
  {
    id: 'req-12',
    title: 'Incidencia: sesión expira sin aviso',
    description: 'El usuario es redirigido al login sin mensaje de sesión expirada.',
    type: 'incidencia',
    status: 'backlog',
    requester_id: 'user-functional-1',
    developer_id: null,
    urgency: 3,
    importance: 2,
    complexity: 1,
    priorityScore: priorityScore(3, 2, 1),
    created_at: '2025-02-06T10:00:00Z',
    updated_at: '2025-02-06T10:00:00Z',
  },
];
